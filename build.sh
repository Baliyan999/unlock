#!/bin/bash

# Скрипт для сборки проекта для продакшена

echo "🚀 Начинаем сборку проекта..."

# Очистка предыдущей сборки
echo "🧹 Очистка предыдущей сборки..."
rm -rf dist/

# Установка зависимостей
echo "📦 Установка зависимостей..."
npm ci

# Проверка линтера
echo "🔍 Проверка кода..."
npm run lint

# Сборка проекта
echo "🏗️  Сборка проекта..."
npm run build

# Проверка результата
if [ -d "dist" ]; then
    echo "✅ Сборка завершена успешно!"
    echo "📊 Размеры файлов:"
    du -h dist/assets/*.js dist/assets/*.css 2>/dev/null || echo "Файлы не найдены"
    
    echo ""
    echo "📁 Содержимое dist/:"
    ls -la dist/
    
    echo ""
    echo "🎉 Проект готов к деплою!"
    echo "📂 Папка dist/ содержит все файлы для продакшена"
else
    echo "❌ Ошибка сборки!"
    exit 1
fi